import{j as P,k as j,a as y,o as A,u as D,c as a,i as l,S as k,d as K,t as f,p as s,E as o,e as M,f as O}from"./index-DwaEUg6H.js";import{S as V,f as m,C as G}from"./safe.form-ClfdFXyO.js";import{M as Q}from"./main.layout-BFKmz6xn.js";import{c as I,a as _,T as N,b as U,S as Y}from"./auth.layout-Nkgzk94H.js";import{c as z}from"./question.model-BEVY-cNY.js";var H=f("<span>Tambah"),J=f('<span class="loading loading-dots loading-lg">'),W=f('<div class="w-full h-screen xl:h-auto xl:w-[30%] 2xl:w-[25%] 3xl:w-[20%] px-4 xl:px-4 2xl:px-5 xl:py-2 overflow-clip"><div class="flex flex-col gap-4"><div class="card shadow-2xl"><div class=card-body><h2 class=card-title>Tambah Pertanyaan</h2><div class="divider divider-lg"></div><div class="form-control flex flex-col items-stretch gap-3"><label class="input input-bordered min-w-full flex items-center gap-2"></label><div class="flex items-center justify-between"></div><div class="divider text-sm"></div><div class="flex justify-center gap-5"><button type=button class="btn btn-block dark:btn-neutral w-[25%]">Kembali</button><button type=submit class="btn btn-block btn-primary w-[25%]">');function re(){const u=P(),{user:b}=j.useAuth(),[$,w]=y(!1),[r,g]=y(!1),e=I({safe_form:_(!1),question:_("",{required:!0,validators:[m.required,m.minLength,m.maxLength]})});A(()=>{b()||u("/404",{replace:!0})});const C=()=>{if(e.isSubmitted){s("System","Formulir sudah dikirimkan",o.ERROR);return}if(!e.isValid){s("System","Silahkan isi semua formulir",o.ERROR);return}if(!G.validateToken()){e.controls.safe_form.setErrors({invalid:"csrf token tidak valid"});return}e.markSubmitted(!0),g(!0),T()},T=async()=>{const t=await z({uid:b()?.id?.toString()||"0",question:e.value.question||""});e.markSubmitted(!1),g(!1),t?(w(!0),s("System","Berhasil menambahkan pertanyaan",o.SUCCESS),u("/question")):s("System","Gagal menambahkan pertanyaan",o.ERROR)};return D(t=>{e.isDirty&&!t.defaultPrevented&&!e.controls.safe_form.errors&&!$()&&(t.preventDefault(),setTimeout(()=>{M.fire({title:"Konfirmasi",icon:"question",showCancelButton:!0,confirmButtonText:"Ya",cancelButtonText:"Tidak",html:Y()}).then(d=>{d.isConfirmed&&t.retry(!0)})},100))}),a(V,{get regenerate(){return!!e.controls.safe_form.errors},get children(){return a(Q,{title:"Tambah Pertanyaan",get children(){var t=W(),d=t.firstChild,q=d.firstChild,R=q.firstChild,E=R.firstChild,B=E.nextSibling,p=B.nextSibling,h=p.firstChild,v=h.nextSibling,F=v.nextSibling,L=F.nextSibling,c=L.firstChild,i=c.nextSibling;return l(h,a(N,{type:"text",name:"question",get disabled(){return r()},placeholder:"Pertanyaan Kamu",get control(){return e.controls.question},class:"grow input outline-none focus:outline-none border-none border-[0px] h-auto pl-1 pr-0"})),l(p,a(U,{name:"Pertanyaan kamu",get control(){return e.controls.question}}),v),c.$$click=()=>u("/question"),i.$$click=C,l(i,a(k,{get when(){return!r()},get children(){return H()}}),null),l(i,a(k,{get when(){return r()},get children(){return J()}}),null),K(n=>{var x=r(),S=r();return x!==n.e&&(c.disabled=n.e=x),S!==n.t&&(i.disabled=n.t=S),n},{e:void 0,t:void 0}),t}})}})}O(["click"]);export{re as default};
