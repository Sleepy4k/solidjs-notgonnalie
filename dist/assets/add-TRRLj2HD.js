import{j,k as A,a as S,o as D,u as K,c as a,i as l,S as y,d as M,t as f,p as s,E as o,e as O,f as V}from"./index-pv8TXPai.js";import{S as G,f as m,C as Q}from"./safe.form-C_zh8uXY.js";import{M as I}from"./main.layout-CBbFEHOj.js";import{c as N,a as k,T as U,b as Y,S as z}from"./auth.layout-CbgWAGRh.js";import{c as H}from"./question.model-B3gn031e.js";var J=f("<span>Tambah"),W=f('<span class="loading loading-dots loading-lg">'),X=f('<div class="w-full h-screen xl:h-auto xl:w-[30%] 2xl:w-[25%] 3xl:w-[20%] px-4 xl:px-4 2xl:px-5 xl:py-2 overflow-clip"><div class="flex flex-col gap-4"><div class="card shadow-2xl"><div class=card-body><h2 class=card-title>Tambah Pertanyaan</h2><div class="divider divider-lg"></div><div class="form-control flex flex-col items-stretch gap-3"><label class=input-bordered></label><div class="flex items-center justify-between"></div><div class="divider text-sm"></div><div class="flex justify-center gap-5"><button type=button class="btn btn-block dark:btn-neutral w-[25%]">Kembali</button><button type=submit class="btn btn-block btn-primary w-[25%]">');function ie(){const d=j(),{user:_,isLogged:$}=A.useAuth(),[w,C]=S(!1),[r,b]=S(!1),e=N({safe_form:k(!1),question:k("",{required:!0,validators:[m.required,m.minLength,m.maxLength]})});D(()=>{$()||d("/404",{replace:!0})});const T=()=>{if(e.isSubmitted){s("System","Formulir sudah dikirimkan",o.ERROR);return}if(!e.isValid){s("System","Silahkan isi semua formulir",o.ERROR);return}if(!Q.validateToken()){e.controls.safe_form.setErrors({invalid:"csrf token tidak valid"});return}e.markSubmitted(!0),b(!0),q()},q=async()=>{const t=await H({uid:_()?.id?.toString()||"0",question:e.value.question||""});e.markSubmitted(!1),b(!1),t?(C(!0),s("System","Berhasil menambahkan pertanyaan",o.SUCCESS),d("/question")):s("System","Gagal menambahkan pertanyaan",o.ERROR)};return K(t=>{e.isDirty&&!t.defaultPrevented&&!e.controls.safe_form.errors&&!w()&&(t.preventDefault(),setTimeout(()=>{O.fire({title:"Konfirmasi",icon:"question",showCancelButton:!0,confirmButtonText:"Ya",cancelButtonText:"Tidak",html:z()}).then(u=>{u.isConfirmed&&t.retry(!0)})},100))}),a(G,{get regenerate(){return!!e.controls.safe_form.errors},get children(){return a(I,{title:"Tambah Pertanyaan",get children(){var t=X(),u=t.firstChild,R=u.firstChild,E=R.firstChild,L=E.firstChild,B=L.nextSibling,g=B.nextSibling,h=g.firstChild,p=h.nextSibling,F=p.nextSibling,P=F.nextSibling,c=P.firstChild,n=c.nextSibling;return l(h,a(U,{type:"textarea",name:"question",get disabled(){return r()},placeholder:"Pertanyaan Kamu",get control(){return e.controls.question},class:"grow input input-bordered h-auto pl-1 pr-0"})),l(g,a(Y,{name:"Pertanyaan kamu",get control(){return e.controls.question}}),p),c.$$click=()=>d("/question"),n.$$click=T,l(n,a(y,{get when(){return!r()},get children(){return J()}}),null),l(n,a(y,{get when(){return r()},get children(){return W()}}),null),M(i=>{var v=r(),x=r();return v!==i.e&&(c.disabled=i.e=v),x!==i.t&&(n.disabled=i.t=x),i},{e:void 0,t:void 0}),t}})}})}V(["click"]);export{ie as default};
